var map;
var ajaxRequest;
var plotlist;
var plotlayers=[];

function initmap() {
	// set up the map
	map = new L.Map('map');

	// create the tile layer with correct attribution
	var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
	//var osmUrl='http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/997/256/{z}/{x}/{y}.png';
	var osmAttrib='Map data © OpenStreetMap contributors';
	var osm = new L.TileLayer(osmUrl, {minZoom: 1, maxZoom: 18, attribution: osmAttrib});		

	map.setView([45.58, 10.21], 14);
	map.addLayer(osm);
	var popup = L.popup();
	map.on('click', function(e){
		popup.setLatLng(e.latlng)
		.setContent('<p>Hai cliccato a <strong>'+e.latlng.toString()+'</strong></p>').openOn(map);
	});
	var geojsonFeature = {
            "type": "Feature",
            "geometry": {
                "type": "Polygon",
                "coordinates": [
                    [
                        [
                            10.2210184832906,
                            45.5857990393085,
                            0
                        ],
                        [
                            10.2219860411839,
                            45.5923006255784,
                            0
                        ],
                        [
                            10.2220256460962,
                            45.5927184654484,
                            0
                        ],
                        [
                            10.2219975390496,
                            45.59278085025671,
                            0
                        ],
                        [
                            10.2218581357308,
                            45.5930902598623,
                            0
                        ],
                        [
                            10.2216102750779,
                            45.5936291463271,
                            0
                        ],
                        [
                            10.2211951965689,
                            45.594201994248,
                            0
                        ],
                        [
                            10.2201177539703,
                            45.5952109060442,
                            0
                        ],
                        [
                            10.2195409363431,
                            45.5957526795266,
                            0
                        ],
                        [
                            10.2156622312706,
                            45.5990073644561,
                            0
                        ],
                        [
                            10.2121978865423,
                            45.6000882923041,
                            0
                        ],
                        [
                            10.2120570473426,
                            45.60013088838601,
                            0
                        ],
                        [
                            10.2116118717364,
                            45.60026552786841,
                            0
                        ],
                        [
                            10.2103347584607,
                            45.6005040912662,
                            0
                        ],
                        [
                            10.2074716677188,
                            45.6009304350246,
                            0
                        ],
                        [
                            10.2071591702027,
                            45.6007087145686,
                            0
                        ],
                        [
                            10.2044607456415,
                            45.5980459191565,
                            0
                        ],
                        [
                            10.2039756623845,
                            45.5975469803597,
                            0
                        ],
                        [
                            10.203437965807,
                            45.59698558718431,
                            0
                        ],
                        [
                            10.1986595927281,
                            45.5905551473801,
                            0
                        ],
                        [
                            10.195151971733,
                            45.5865684746496,
                            0
                        ],
                        [
                            10.1949937818551,
                            45.58636310764,
                            0
                        ],
                        [
                            10.1948860948401,
                            45.5861212082486,
                            0
                        ],
                        [
                            10.1948748986752,
                            45.5837810747501,
                            0
                        ],
                        [
                            10.194851653776,
                            45.58147707024941,
                            0
                        ],
                        [
                            10.1947879785514,
                            45.5812800938542,
                            0
                        ],
                        [
                            10.1915981845649,
                            45.5744653026779,
                            0
                        ],
                        [
                            10.1908637345219,
                            45.573525852121,
                            0
                        ],
                        [
                            10.1904996313666,
                            45.5732776202255,
                            0
                        ],
                        [
                            10.1901097145013,
                            45.5730206551458,
                            0
                        ],
                        [
                            10.1892545313388,
                            45.5725795133817,
                            0
                        ],
                        [
                            10.199585862885,
                            45.57265149622711,
                            0
                        ],
                        [
                            10.2111255012054,
                            45.5699794292776,
                            0
                        ],
                        [
                            10.2135302773756,
                            45.5701043363896,
                            0
                        ],
                        [
                            10.2159871641387,
                            45.57373577399381,
                            0
                        ],
                        [
                            10.2171858895158,
                            45.5756028442884,
                            0
                        ],
                        [
                            10.2188862103937,
                            45.57829821398951,
                            0
                        ],
                        [
                            10.2203523920937,
                            45.58081117634641,
                            0
                        ],
                        [
                            10.2206868168554,
                            45.58156199690101,
                            0
                        ],
                        [
                            10.2209019682127,
                            45.58231409136521,
                            0
                        ],
                        [
                            10.2209527792487,
                            45.58279862519001,
                            0
                        ],
                        [
                            10.2211036403981,
                            45.5849662875761,
                            0
                        ],
                        [
                            10.2210184832906,
                            45.5857990393085,
                            0
                        ]
                    ]
                ]
            },
            "properties": {
                "name": "COLLEBEATO"
            }
        };
	L.geoJson(geojsonFeature).addTo(map);
}
window.onload = function(){
	initmap();

	//// create the tile layer with correct attribution
	//var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
	//var osmAttrib='Map data © OpenStreetMap contributors';
	//var osm = new L.TileLayer(osmUrl, {minZoom: 8, maxZoom: 12, attribution: osmAttrib});
	//map.setView([45.5333, 10.2333], 13);
	//map.addLayer(osm);
}
